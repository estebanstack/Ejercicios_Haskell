import Data.Char (digitToInt)

main :: IO ()
main = do
    putStrLn "Ingrese los números de su tarjeta de crédito: "
    tarjeta <- getLine
    
    let digitos = map digitToInt tarjeta
        digitosProcesados = validate (reverse digitos)
        suma = sum digitosProcesados

    print (suma `mod` 10 == 0)


validate :: [Int] -> [Int]
validate [] = []
validate (x:y:xs) = x : doubleEveryOther y : validate xs
validate [x] = [x]  


doubleEveryOther :: Int -> Int
doubleEveryOther n = if n * 2 > 9 then (n * 2 - 9) else n * 2
